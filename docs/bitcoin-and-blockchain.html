























<!DOCTYPE html>
<html>
  <head>
    <title>Bitcoin and Blockchain</title>
    <meta charset="utf-8">
    <script src="/static/hljs/hljs.js"></script>
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon"/>
    <link rel="stylesheet" type="text/css" href="/static/hljs/hljs.css">
    <script type="text/javascript">
      hljs.initHighlightingOnLoad()
    </script>

    <script>
      var notesEnabled =  false ;
    </script>
    <script src="/static/slide.js"></script>


    
  </head>

  <body style="display: none">
    <section class='slides layout-widescreen'>
      <article>
        <h1>Bitcoin and Blockchain</h1>

        

        
          <h3>26 March 2018
        </h3>
        

        <p class="misc">
          
            

            CJ Ting
          
        </p>
      </article>

      
        <article >
          
            <h2>基础知识</h2>
          

          <span class="pagenumber">2</span>
        </article>
      
        <article >
          
            <h3>哈希算法</h3>

            
              
  
    <p>
      
        
        也叫摘要算法，计算 <b>任意长度</b> 输入的摘要，产生一个 <b>固定长度</b> 的输出，这个输出叫做 <b>哈希值</b>。
      
    </p>
  

            
              
  
    <p>
      
        
        常见的哈希算法有 <code class="inline">MD5</code>, <code class="inline">SHA256</code>, <code class="inline">SHA512</code> 等。
      
    </p>
  

            
              
  
    <p>
      
        
        特点：
      
    </p>
  

            
              
  <ul>
  
    <li>无冲突：无法找到两个不一样的输入，产生同样的哈希值，注意，是无法找到</li>
  
    <li>不可逆：无法由输出推导输入</li>
  
  </ul>

            
          

          <span class="pagenumber">3</span>
        </article>
      
        <article >
          
            <h3>数字签名</h3>

            
              
  
    <p>
      
        
        数字签名和我们传统的签名一样，满足两个性质：
      
    </p>
  

            
              
  <ul>
  
    <li>只有特定的人可以签，但是所有人都可以验证</li>
  
    <li>签名和特定的内容绑定在一起，剪切复制是没用的</li>
  
  </ul>

            
              
  
    <p>
      
        
        目前使用的数字签名一般由 <b>非对称秘钥</b> 实现，有两把钥匙，一把秘钥，一把公钥，公钥公之于众。
      
    </p>
  

            
              
  <ul>
  
    <li>消息发布者可以使用 <code class="inline">秘钥 + 消息</code> 产生签名</li>
  
    <li>其他人可以使用 <code class="inline">公钥 + 消息 + 签名</code> 来验证有效性</li>
  
  </ul>

            
          

          <span class="pagenumber">4</span>
        </article>
      
        <article >
          
            <h2>身份认证</h2>
          

          <span class="pagenumber">5</span>
        </article>
      
        <article >
          
            <h3>ECDSA 认证系统</h3>

            
              
  
    <p>
      
        
        <i>SK (Secret Key, 秘钥)</i>:
      
    </p>
  

            
              
  
    <p>
      
        
        <code class="inline">f46b86f8d9b7d7008b6a7f940ba782663e2f06eccea272a375ee49d74ec1e9f8</code>
      
    </p>
  

            
              
  
    <p>
      
        
        <i>WA (Wallet Address, 钱包地址)</i>:
      
    </p>
  

            
              
  
    <p>
      
        
        <code class="inline">02ab20170e07d7f701ce7c4e5fa30bac0841c0aab6a448c7ee848af3b1a7e1cb7f18SGifBJgDWnARXaHUmM8E3FJAHnLcxZhW</code>
      
    </p>
  

            
              
  <ul>
  
    <li>SK -&gt; WA: 使用 SK 可以生成 WA，这个过程不可逆 <code class="inline">dingxijin</code></li>
  
    <li>SK 和 WA 构成了非对称秘钥系统，即 SK 签名，WA 可以验证</li>
  
    <li>持有比特币的唯一方式为：<b>持有比特币 WA 对应的 SK</b></li>
  
  </ul>

            
          

          <span class="pagenumber">6</span>
        </article>
      
        <article >
          
            <h2>Q: SK 是怎样生成的呢？有什么条件吗?</h2>
          

          <span class="pagenumber">7</span>
        </article>
      
        <article >
          
            <h2>A: 没有任何条件，使用计算机随机生成就行。</h2>
          

          <span class="pagenumber">8</span>
        </article>
      
        <article >
          
            <h2>点对点网络</h2>
          

          <span class="pagenumber">9</span>
        </article>
      
        <article >
          
            <h3>点对点，去中心</h3>

            
              
  <ul>
  
    <li><b>任何计算机</b> 都可以下载运行比特币程序，从而成为比特币网络中的一个节点。</li>
  
  </ul>

            
              
  <ul>
  
    <li>去中心意味着整个系统中没有中心节点，<b>所有节点都是平等的</b>。</li>
  
  </ul>

            
              
  <ul>
  
    <li>每个节点拥有比特币的完整数据，因此，<b>破坏比特币的唯一方式是摧毁所有的节点</b>。</li>
  
  </ul>

            
          

          <span class="pagenumber">10</span>
        </article>
      
        <article >
          
            <h2>Q: 为什么大家会愿意成为比特币的节点？</h2>
          

          <span class="pagenumber">11</span>
        </article>
      
        <article >
          
            <h2>A: 因为成为节点参与挖矿，可以获得比特币的奖励。</h2>
          

          <span class="pagenumber">12</span>
        </article>
      
        <article >
          
            <h2>交易</h2>
          

          <span class="pagenumber">13</span>
        </article>
      
        <article >
          
            <h3>交易流程</h3>

            
              
  <ul>
  
    <li>钱包（一个软件）构造一条交易</li>
  
    <li>向节点发送交易</li>
  
    <li>节点验证交易有效性</li>
  
    <li>向其他节点广播该交易</li>
  
    <li>交易被存储进区块中</li>
  
  </ul>

            
          

          <span class="pagenumber">14</span>
        </article>
      
        <article >
          
            <h3>交易结构</h3>

            
              
  
    <p>
      
        
        交易由两部分构成，输入相当于汇款方，输出相当于收款方。
      
    </p>
  

            
              
  
    <p>
      
        
        输入，可能有多个
      
    </p>
  

            
              
  <ul>
  
    <li><code class="inline">UTXO(Unspent Transaction Output)</code>: 某一个交易的输出</li>
  
    <li><code class="inline">解锁脚本</code>: 用来解锁上述的 UTXO</li>
  
  </ul>

            
              
  
    <p>
      
        
        输出，可能有多个
      
    </p>
  

            
              
  <ul>
  
    <li><code class="inline">锁定脚本</code>: 指定了消费这段输出的条件</li>
  
    <li><code class="inline">金额</code></li>
  
  </ul>

            
          

          <span class="pagenumber">15</span>
        </article>
      
        <article >
          
            <h3>锁定脚本和解锁脚本</h3>

            
              
  
    <p>
      
        
        锁定脚本和解锁脚本是一套小型的编程语言，为什么不设计成直接校验签名而要弄一套脚本系统？
      
    </p>
  

            
              
  
    <p>
      
        
        因为脚本可以用来指定复杂的消费校验方式。
      
    </p>
  

            
              
  
    <p>
      
        
        比特币中绝大部分交易，消费校验都是提供 WA 对应的签名即可。
      
    </p>
  

            
              
  <ul>
  
    <li>锁定脚本中的内容：WA</li>
  
  </ul>

            
              
  <ul>
  
    <li>解锁脚本：签名（消息为交易哈希值）</li>
  
  </ul>

            
              
  
    <p>
      
        
        节点使用 <i>WA + 签名 + 消息 （交易哈希值）</i> 即可确认解锁脚本是否有效。
      
    </p>
  

            
          

          <span class="pagenumber">16</span>
        </article>
      
        <article >
          
            <h2>Q: 消费校验还有哪些可能的方式？</h2>
          

          <span class="pagenumber">17</span>
        </article>
      
        <article >
          
            <h2>A: 联合账户，比如必须提供三个人中两个人的签名。</h2>
          

          <span class="pagenumber">18</span>
        </article>
      
        <article >
          
            <h3>交易图解</h3>

            
              
  <div class="image">
    <img src="bitcoin-and-blockchain/transaction.svg"  >
  </div>

            
          

          <span class="pagenumber">19</span>
        </article>
      
        <article >
          
            <h2>Q: 输入金额一定等于输出金额吗？</h2>
          

          <span class="pagenumber">20</span>
        </article>
      
        <article >
          
            <h2>A: 不一定，之间的差额就是手续费。</h2>
          

          <span class="pagenumber">21</span>
        </article>
      
        <article >
          
            <h2>Q: 交易有效性需要检查哪些点？</h2>
          

          <span class="pagenumber">22</span>
        </article>
      
        <article >
          
            <h2>A: UTXO 没有被消费，解锁脚本和锁定脚本匹配，输入金额需要大于输出金额。</h2>
          

          <span class="pagenumber">23</span>
        </article>
      
        <article >
          
            <h2>Q: 如何知道一个 WA 的余额是多少？</h2>
          

          <span class="pagenumber">24</span>
        </article>
      
        <article >
          
            <h3>A: 根据交易推导</h3>

            
              
  
    <p>
      
        
        比特币没有直接的账户余额，一个 WA 对应的余额需要使用目前所有的交易推导出来。
      
    </p>
  

            
              
  
    <p>
      
        
        交易之间形成一个链条，每一笔交易都能追根溯源。如果你要转钱给别人，一定是有人先转钱给你。
      
    </p>
  

            
          

          <span class="pagenumber">25</span>
        </article>
      
        <article >
          
            <h2>Q: 最初的钱怎么来的？</h2>
          

          <span class="pagenumber">26</span>
        </article>
      
        <article >
          
            <h2>A: 这就是著名的“挖矿”。</h2>
          

          <span class="pagenumber">27</span>
        </article>
      
        <article >
          
            <h2>产生</h2>
          

          <span class="pagenumber">28</span>
        </article>
      
        <article >
          
            <h3>区块</h3>

            
              
  
    <p>
      
        
        <i>挖矿</i>：节点将交易打包在一起，形成区块的过程。
      
    </p>
  

            
              
  
    <p>
      
        
        一个区块由以下部分构成：
      
    </p>
  

            
              
  <ul>
  
    <li>多个交易记录</li>
  
    <li>父区块的哈希值</li>
  
    <li>困难度(一个数字)</li>
  
    <li>时间戳</li>
  
    <li>随机数</li>
  
  </ul>

            
              
  
    <p>
      
        
        由于每个区块都含有上个区块的哈希值，因此，区块之间形成一个链条，也就是所谓的 <i>区块链</i>。
      
    </p>
  

            
          

          <span class="pagenumber">29</span>
        </article>
      
        <article >
          
            <h2>Q: 第一个区块的父区块是什么呢？</h2>
          

          <span class="pagenumber">30</span>
        </article>
      
        <article >
          
            <h2>A: 这个区块叫做创世区块，它的内容硬编码在软件当中。</h2>
          

          <span class="pagenumber">31</span>
        </article>
      
        <article >
          
            <h2>Q: 挖矿时如何选择包含哪些交易？</h2>
          

          <span class="pagenumber">32</span>
        </article>
      
        <article >
          
            <h3>A: 存在一个优先级算法</h3>

            
              
  
    <p>
      
        
        算法会考虑如下因素
      
    </p>
  

            
              
  <ul>
  
    <li>交易的价值</li>
  
    <li>UTXO 所在区块距顶端的长度</li>
  
    <li>交易数据量大小</li>
  
    <li>交易手续费</li>
  
  </ul>

            
          

          <span class="pagenumber">33</span>
        </article>
      
        <article >
          
            <h2>Q: 困难度是个什么东西？用来做什么？</h2>
          

          <span class="pagenumber">34</span>
        </article>
      
        <article >
          
            <h2>A: 这就涉及到比特币达成共识的核心设计，POW，工作量证明。</h2>
          

          <span class="pagenumber">35</span>
        </article>
      
        <article >
          
            <h3>POW, Proof of Work</h3>

            
              
  
    <p>
      
        
        每个节点都可以形成区块，但是形成区块必须满足特定的条件：<b>区块的哈希值（当做整数来解读）必须小于困难度。</b>
      
    </p>
  

            
              
  
    <p>
      
        
        由于哈希算法的特性，<b>找到吻合条件哈希值的唯一做法是尝试</b>。尝试的过程就是不停地修改随机数，计算哈希值，检验哈希值是否吻合条件。
      
    </p>
  

            
              
  
    <p>
      
        
        一旦某个节点找到了特定的随机数使得哈希值满足条件，也就是所谓的“挖到了矿”，那么这个区块就会被加入到链中，同时广播给网络中其他节点，其他节点收到消息后，校验区块的有效性，然后立刻开始“挖下一个矿”。
      
    </p>
  

            
          

          <span class="pagenumber">36</span>
        </article>
      
        <article >
          
            <h2>Q: 困难度是一个固定的数字吗？</h2>
          

          <span class="pagenumber">37</span>
        </article>
      
        <article >
          
            <h2>A: 不是。</h2>
          

          <span class="pagenumber">38</span>
        </article>
      
        <article >
          
            <h2>Q: 为什么？</h2>
          

          <span class="pagenumber">39</span>
        </article>
      
        <article >
          
            <h2>A: 因为计算能力在增加，如果困难度是一个固定的数字，比特币就会越挖越快，导致价值下跌以及系统不稳定。</h2>
          

          <span class="pagenumber">40</span>
        </article>
      
        <article >
          
            <h2>Q: 作为一个分布式系统，比特币如何调整困难度？</h2>
          

          <span class="pagenumber">41</span>
        </article>
      
        <article >
          
            <h3>A: 根据时间来调整</h3>

            
              
  
    <p>
      
        
        算法很简单，每 2016 个区块以后，节点会根据生成 2016 个区块的实际时间以及理论时间（每 10 分钟一个区块），调整困难度，因此，<b>无论网络节点多少，无论计算能力大小，比特币始终保持在 10 分钟一个区块</b>。
      
    </p>
  

            
          

          <span class="pagenumber">42</span>
        </article>
      
        <article >
          
            <h2>Q: 比特币的交易速度是多少？每分钟可以完成多少笔交易？</h2>
          

          <span class="pagenumber">43</span>
        </article>
      
        <article >
          
            <h3>A: 区块中包含的交易数量 / 10分钟</h3>

            
              
  
    <p>
      
        
        区块中的交易数量平均值在 2000 左右，因此比特币的交易速率平均为 <i>200笔 / 分钟</i>，作为一个全球货币，这个交易速度非常低，是比特币的一个重大缺陷。
      
    </p>
  

            
          

          <span class="pagenumber">44</span>
        </article>
      
        <article >
          
            <h3>生成交易</h3>

            
              
  
    <p>
      
        
        每个区块的第一个交易是 <b>生成交易(Generation Transaction)</b>。这个交易 <b>没有输入，只有输出</b>。
      
    </p>
  

            
              
  
    <p>
      
        
        生成交易将 <b>系统奖励 + 手续费</b> 输出到挖矿人员设定的钱包地址，这就是比特币产生的根源。
      
    </p>
  

            
          

          <span class="pagenumber">45</span>
        </article>
      
        <article >
          
            <h2>Q: 挖矿需要消耗什么资源？</h2>
          

          <span class="pagenumber">46</span>
        </article>
      
        <article >
          
            <h2>A: 一次性投资的硬件 &#43; 维持硬件运作的电力</h2>
          

          <span class="pagenumber">47</span>
        </article>
      
        <article >
          
            <h2>Q: 同时有多台节点挖到矿怎么处理？</h2>
          

          <span class="pagenumber">48</span>
        </article>
      
        <article >
          
            <h3>A: 这就是所谓的“分叉”，节点会维护分叉的链，直到下一个区块到来。</h3>

            
              
  <div class="image">
    <img src="bitcoin-and-blockchain/fork.svg"  height="500"  >
  </div>

            
          

          <span class="pagenumber">49</span>
        </article>
      
        <article >
          
            <h2>Q: 分叉会造成怎样的影响？</h2>
          

          <span class="pagenumber">50</span>
        </article>
      
        <article >
          
            <h2>A: 分叉会修改区块链，导致交易无效，比如著名的 51% 攻击。</h2>
          

          <span class="pagenumber">51</span>
        </article>
      
        <article >
          
            <h3>51% Attack(1)</h3>

            
              
  
    <p>
      
        
        考虑这样一个情景：A与B之间有一笔大额交易，使用比特币支付。
      
    </p>
  

            
              
  
    <p>
      
        
        交易为 T1， B 在等到交易进入区块 B2 以后，就交付货品给 A。
      
    </p>
  

            
              
  
    <p>
      
        
        此时，A 立刻调用大量计算能力，在 B1 的基础上重新挖矿得到 B3，B3 中有一笔交易 T2，使用和 T1 同样的 UTXO，但是输出为 A 自己的账户。
      
    </p>
  

            
              
  
    <p>
      
        
        紧接着在 B3 的基础上挖出 B4（A 掌握了 51% 的计算能力），那么 B2 就会彻底作废。A 同时拿到了钱和货。
      
    </p>
  

            
          

          <span class="pagenumber">52</span>
        </article>
      
        <article >
          
            <h3>51% Attack(2)</h3>

            
              
  <div class="image">
    <img src="bitcoin-and-blockchain/attack.svg"  >
  </div>

            
          

          <span class="pagenumber">53</span>
        </article>
      
        <article >
          
            <h2>Q: T1 为何无效了？</h2>
          

          <span class="pagenumber">54</span>
        </article>
      
        <article >
          
            <h2>A: 节点收到 T1 后，会发现它的 UTXO 已经被支付，因此判定 T1 无效。</h2>
          

          <span class="pagenumber">55</span>
        </article>
      
        <article >
          
            <h2>Q: 如何防范此类攻击？</h2>
          

          <span class="pagenumber">56</span>
        </article>
      
        <article >
          
            <h3>A: 非常简单，等到确认度增加以后再进行交付</h3>

            
              
  
    <p>
      
        
        <b>确认度</b> 指的是交易所在的区块前面还有多少区块（包含该区块），确认度越高，链条越长，越无法修改，越安全。
      
    </p>
  

            
              
  
    <p>
      
        
        一般 10 以上就十分安全了，要推翻 10 个区块需要巨大的计算量，目前没有个体和团体能做到，这个方法的缺点是需要等待。
      
    </p>
  

            
          

          <span class="pagenumber">57</span>
        </article>
      
        <article >
          
            <h2>Q: 确认度为 0 的交易安全吗？也就是交易还没有被挖进区块中。</h2>
          

          <span class="pagenumber">58</span>
        </article>
      
        <article >
          
            <h3>A: 当然不安全</h3>

            
              
  
    <p>
      
        
        这个交易可以被轻松撤销，只适用于非常小额的交易，比如买一杯咖啡。
      
    </p>
  

            
              
  
    <p>
      
        
        假设交易为 <code class="inline">A -&gt; B(T1)</code>，因为交易没有被挖进区块中，A 可以再构造一个交易，<code class="inline">A -&gt; A(T2)</code>，如果 T2 先进入区块(通过增加手续费的方式)，那么 T1 就会无效。
      
    </p>
  

            
          

          <span class="pagenumber">59</span>
        </article>
      
        <article >
          
            <h3>总结</h3>

            
              
  
    <p>
      
        
        到了这里，我想大家应该对比特币的整个系统运作有了一定的理解。
      
    </p>
  

            
              
  <ul>
  
    <li>比特币怎么产生？</li>
  
    <li>怎样交易？</li>
  
    <li>怎样持有？</li>
  
    <li>有什么优点？</li>
  
    <li>有什么缺点？</li>
  
    <li>它底层的区块链技术有什么特点？</li>
  
  </ul>

            
              
  
    <p>
      
        
        <i>注意，这次分享意在说明比特币的工作原理，希望能帮助大家站在一个整体的角度上去理解比特币，重在概念性解释，因此部分技术细节做了调整方便大家理解，不一定准确。</i>
      
    </p>
  

            
          

          <span class="pagenumber">60</span>
        </article>
      

      <article>
        <h3>Thank you</h3>

        <p class="misc">
          
            

            CJ Ting
          
        </p>
      </article>
    </section>

    <div id="help">
      Use the left and right arrow keys or click the left and right
      edges of the page to navigate between slides.<br>
      (Press 'H' or navigate to hide this message.)
    </div>

    
    <div style="display: none">
      <script type="text/javascript" src="https://s23.cnzz.com/z_stat.php?id=1277831247&web_id=1277831247"></script>
    </div>
  </body>
</html>
