<!DOCTYPE html>
<html>
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16" />
  <link rel="stylesheet" type="text/css" href="normalize.css">
  <link rel="stylesheet" type="text/css" href="font/font.css">
  <link rel="stylesheet" type="text/css" href="slide.css">
</head>
<body>
  <script src="remark.min.js" type="text/javascript"></script>
  <script type="text/javascript">
    var title = new URLSearchParams(location.search).get("title")
    document.title = "CJ Ting's slide: " + title
    var slideshow = remark.create({
      sourceUrl: "slides/" + title + "/index.md",
      highlightLines: true,
      highlightStyle: "tomorrow",
      navigation: {
        scroll: false,
      },
    })

    function initWebSocket() {
      var ws = new WebSocket(`ws://${location.host}/ws`)
      ws.onerror = () => console.log("WebSocket error")
      ws.onopen = () => console.log("WebSocket connection established")
      ws.onclose = () => console.log("WebSocket connection closed")
      ws.onmessage = evt => {
        switch(evt.data) {
          case "gotoNextSlide":
            slideshow.gotoNextSlide()
            break
          case "gotoPreviousSlide":
            slideshow.gotoPreviousSlide()
            break
          default:
            console.log("Unknown message:", msg)
        }
      }
    }

    if(location.port !== "") {
      initWebSocket()
    }
  </script>
</body>
</html>
